2025-08-12 07:56:12,152 - DBClient - INFO - 正在建立一個新的 DBClient 實例...
2025-08-12 07:56:12,152 - DBClient - INFO - 使用硬編碼的 DB Manager 埠號: 49999
2025-08-12 07:56:12,305 - api_server - INFO - 🚀 啟動 API 伺服器 (v3)...
2025-08-12 07:56:12,306 - api_server - INFO - 請在瀏覽器中開啟 http://127.0.0.1:42649
INFO:     Started server process [7186]
INFO:     Waiting for application startup.
2025-08-12 07:56:12,392 - api_server - INFO - 資料庫日誌處理器設定完成 (source: api_server)。
2025-08-12 07:56:12,401 - api_server - INFO - 資料庫日誌處理器已透過 lifespan 事件設定。
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:42649 (Press CTRL+C to quit)
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [7186]
2025-08-12 07:57:04,806 - DBClient - INFO - 正在建立一個新的 DBClient 實例...
2025-08-12 07:57:04,806 - DBClient - INFO - 使用硬編碼的 DB Manager 埠號: 49999
2025-08-12 07:57:04,884 - api_server - INFO - 🚀 啟動 API 伺服器 (v3)...
2025-08-12 07:57:04,884 - api_server - INFO - 請在瀏覽器中開啟 http://127.0.0.1:42649
INFO:     Started server process [7570]
INFO:     Waiting for application startup.
2025-08-12 07:57:04,923 - api_server - INFO - 資料庫日誌處理器設定完成 (source: api_server)。
2025-08-12 07:57:04,929 - api_server - INFO - 資料庫日誌處理器已透過 lifespan 事件設定。
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:42649 (Press CTRL+C to quit)
INFO:     127.0.0.1:36404 - "WebSocket /api/ws" [accepted]
2025-08-12 07:57:05,925 - api_server - INFO - 新用戶端連線。目前共 1 個連線。
INFO:     connection open
2025-08-12 07:57:05,930 - api_server - INFO - 從 WebSocket 收到訊息: {"type": "START_YOUTUBE_PROCESSING", "payload": {"task_id": "c7d3a445-a445-41ba-83ff-e8f9d1380906"}}
2025-08-12 07:57:05,932 - api_server - INFO - 收到開始處理 YouTube 任務鏈的請求 (起始任務 ID: c7d3a445-a445-41ba-83ff-e8f9d1380906)。
2025-08-12 07:57:05,935 - api_server - INFO - 🧵 [執行緒] 開始處理 YouTube 任務鏈，起始 ID: c7d3a445-a445-41ba-83ff-e8f9d1380906
2025-08-12 07:57:05,936 - api_server - INFO - 一個用戶端離線。目前共 0 個連線。
2025-08-12 07:57:05,942 - api_server - INFO - WebSocket 用戶端已離線。
2025-08-12 07:57:05,947 - api_server - INFO - ✅ 回傳任務 c7d3a445-a445-41ba-83ff-e8f9d1380906 的狀態: pending
INFO:     connection closed
2025-08-12 07:57:06,240 - api_server - INFO - ✅ [執行緒] YouTube 音訊下載完成: /app/uploads/dummy_audio.wav
2025-08-12 07:57:06,252 - api_server - INFO - 執行 Gemini 分析，任務: 'summary,transcript', 格式: 'html'
2025-08-12 07:57:08,141 - api_server - ERROR - ❌ [執行緒] YouTube 處理鏈中發生錯誤: Gemini processor failed with exit code 1. Stderr: {"type": "result", "status": "failed", "error": "GOOGLE_API_KEY environment variable not set."}
Traceback (most recent call last):
  File "/app/api_server.py", line 891, in _process_in_thread
    raise RuntimeError(f"Gemini processor failed with exit code {process_gemini.returncode}. Stderr: {stdout_output}")
RuntimeError: Gemini processor failed with exit code 1. Stderr: {"type": "result", "status": "failed", "error": "GOOGLE_API_KEY environment variable not set."}

2025-08-12 07:57:10,956 - api_server - INFO - ✅ 回傳任務 c7d3a445-a445-41ba-83ff-e8f9d1380906 的狀態: completed
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [7570]
2025-08-12 07:57:42,596 - DBClient - INFO - 正在建立一個新的 DBClient 實例...
2025-08-12 07:57:42,597 - DBClient - INFO - 使用硬編碼的 DB Manager 埠號: 49999
2025-08-12 07:57:42,681 - api_server - INFO - 🚀 啟動 API 伺服器 (v3)...
2025-08-12 07:57:42,681 - api_server - INFO - 請在瀏覽器中開啟 http://127.0.0.1:42649
INFO:     Started server process [7898]
INFO:     Waiting for application startup.
2025-08-12 07:57:42,723 - api_server - INFO - 資料庫日誌處理器設定完成 (source: api_server)。
2025-08-12 07:57:42,729 - api_server - INFO - 資料庫日誌處理器已透過 lifespan 事件設定。
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:42649 (Press CTRL+C to quit)
INFO:     127.0.0.1:36676 - "WebSocket /api/ws" [accepted]
2025-08-12 07:57:43,747 - api_server - INFO - 新用戶端連線。目前共 1 個連線。
INFO:     connection open
2025-08-12 07:57:43,751 - api_server - INFO - 從 WebSocket 收到訊息: {"type": "START_YOUTUBE_PROCESSING", "payload": {"task_id": "f27a157c-6bac-4d4e-bac6-a09ac9c5234c"}}
2025-08-12 07:57:43,753 - api_server - INFO - 收到開始處理 YouTube 任務鏈的請求 (起始任務 ID: f27a157c-6bac-4d4e-bac6-a09ac9c5234c)。
2025-08-12 07:57:43,755 - api_server - INFO - 🧵 [執行緒] 開始處理 YouTube 任務鏈，起始 ID: f27a157c-6bac-4d4e-bac6-a09ac9c5234c
2025-08-12 07:57:43,756 - api_server - INFO - 一個用戶端離線。目前共 0 個連線。
2025-08-12 07:57:43,758 - api_server - INFO - WebSocket 用戶端已離線。
2025-08-12 07:57:43,762 - api_server - INFO - ✅ 回傳任務 f27a157c-6bac-4d4e-bac6-a09ac9c5234c 的狀態: pending
INFO:     connection closed
2025-08-12 07:57:43,946 - api_server - INFO - ✅ [執行緒] YouTube 音訊下載完成: /app/uploads/dummy_audio.wav
2025-08-12 07:57:43,955 - api_server - INFO - 執行 Gemini 分析，任務: 'summary,transcript', 格式: 'html'
2025-08-12 07:57:45,160 - api_server - ERROR - ❌ [執行緒] YouTube 處理鏈中發生錯誤: Gemini processor failed with exit code 1. Stderr: {"type": "result", "status": "failed", "error": "GOOGLE_API_KEY environment variable not set."}
Traceback (most recent call last):
  File "/app/api_server.py", line 891, in _process_in_thread
    raise RuntimeError(f"Gemini processor failed with exit code {process_gemini.returncode}. Stderr: {stdout_output}")
RuntimeError: Gemini processor failed with exit code 1. Stderr: {"type": "result", "status": "failed", "error": "GOOGLE_API_KEY environment variable not set."}

2025-08-12 07:57:48,770 - api_server - INFO - ✅ 回傳任務 f27a157c-6bac-4d4e-bac6-a09ac9c5234c 的狀態: completed
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [7898]
2025-08-12 07:58:53,461 - DBClient - INFO - 正在建立一個新的 DBClient 實例...
2025-08-12 07:58:53,461 - DBClient - INFO - 使用硬編碼的 DB Manager 埠號: 49999
2025-08-12 07:58:53,539 - api_server - INFO - 🚀 啟動 API 伺服器 (v3)...
2025-08-12 07:58:53,539 - api_server - INFO - 請在瀏覽器中開啟 http://127.0.0.1:42649
INFO:     Started server process [8446]
INFO:     Waiting for application startup.
2025-08-12 07:58:53,581 - api_server - INFO - 資料庫日誌處理器設定完成 (source: api_server)。
2025-08-12 07:58:53,586 - api_server - INFO - 資料庫日誌處理器已透過 lifespan 事件設定。
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:42649 (Press CTRL+C to quit)
INFO:     127.0.0.1:46188 - "WebSocket /api/ws" [accepted]
2025-08-12 07:58:54,600 - api_server - INFO - 新用戶端連線。目前共 1 個連線。
INFO:     connection open
2025-08-12 07:58:54,607 - api_server - INFO - 從 WebSocket 收到訊息: {"type": "START_YOUTUBE_PROCESSING", "payload": {"task_id": "75db1ee9-fb63-4127-a9ac-f03bb70df5e1"}}
2025-08-12 07:58:54,610 - api_server - INFO - 收到開始處理 YouTube 任務鏈的請求 (起始任務 ID: 75db1ee9-fb63-4127-a9ac-f03bb70df5e1)。
2025-08-12 07:58:54,613 - api_server - INFO - 🧵 [執行緒] 開始處理 YouTube 任務鏈，起始 ID: 75db1ee9-fb63-4127-a9ac-f03bb70df5e1
2025-08-12 07:58:54,616 - api_server - INFO - 一個用戶端離線。目前共 0 個連線。
2025-08-12 07:58:54,622 - api_server - INFO - WebSocket 用戶端已離線。
2025-08-12 07:58:54,627 - api_server - INFO - ✅ 回傳任務 75db1ee9-fb63-4127-a9ac-f03bb70df5e1 的狀態: pending
INFO:     connection closed
2025-08-12 07:58:54,843 - api_server - INFO - ✅ [執行緒] YouTube 音訊下載完成: /app/uploads/dummy_audio.wav
2025-08-12 07:58:54,854 - api_server - INFO - 執行 Gemini 分析，任務: 'summary,transcript', 格式: 'html'
2025-08-12 07:58:56,214 - api_server - ERROR - ❌ [執行緒] YouTube 處理鏈中發生錯誤: Gemini processor failed with exit code 1. Stderr: {"type": "result", "status": "failed", "error": "GOOGLE_API_KEY environment variable not set."}
Traceback (most recent call last):
  File "/app/api_server.py", line 891, in _process_in_thread
    raise RuntimeError(f"Gemini processor failed with exit code {process_gemini.returncode}. Stderr: {stdout_output}")
RuntimeError: Gemini processor failed with exit code 1. Stderr: {"type": "result", "status": "failed", "error": "GOOGLE_API_KEY environment variable not set."}

2025-08-12 07:58:59,637 - api_server - INFO - ✅ 回傳任務 75db1ee9-fb63-4127-a9ac-f03bb70df5e1 的狀態: completed
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [8446]
2025-08-12 07:59:38,380 - DBClient - INFO - 正在建立一個新的 DBClient 實例...
2025-08-12 07:59:38,380 - DBClient - INFO - 使用硬編碼的 DB Manager 埠號: 49999
2025-08-12 07:59:38,456 - api_server - INFO - 🚀 啟動 API 伺服器 (v3)...
2025-08-12 07:59:38,456 - api_server - INFO - 請在瀏覽器中開啟 http://127.0.0.1:42649
INFO:     Started server process [8778]
INFO:     Waiting for application startup.
2025-08-12 07:59:38,494 - api_server - INFO - 資料庫日誌處理器設定完成 (source: api_server)。
2025-08-12 07:59:38,499 - api_server - INFO - 資料庫日誌處理器已透過 lifespan 事件設定。
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:42649 (Press CTRL+C to quit)
INFO:     127.0.0.1:42266 - "WebSocket /api/ws" [accepted]
2025-08-12 07:59:39,522 - api_server - INFO - 新用戶端連線。目前共 1 個連線。
INFO:     connection open
2025-08-12 07:59:39,527 - api_server - INFO - 從 WebSocket 收到訊息: {"type": "START_YOUTUBE_PROCESSING", "payload": {"task_id": "5fe2e17f-a4d5-47b7-a455-fa7b1921dafd"}}
2025-08-12 07:59:39,529 - api_server - INFO - 收到開始處理 YouTube 任務鏈的請求 (起始任務 ID: 5fe2e17f-a4d5-47b7-a455-fa7b1921dafd)。
2025-08-12 07:59:39,531 - api_server - INFO - 🧵 [執行緒] 開始處理 YouTube 任務鏈，起始 ID: 5fe2e17f-a4d5-47b7-a455-fa7b1921dafd
2025-08-12 07:59:39,532 - api_server - INFO - 一個用戶端離線。目前共 0 個連線。
2025-08-12 07:59:39,537 - api_server - INFO - WebSocket 用戶端已離線。
2025-08-12 07:59:39,542 - api_server - INFO - ✅ 回傳任務 fe281860-43f1-4685-a5fc-7b2a8323b499 的狀態: pending
INFO:     connection closed
2025-08-12 07:59:39,748 - api_server - INFO - ✅ [執行緒] YouTube 音訊下載完成: /app/uploads/dummy_audio.wav
2025-08-12 07:59:39,758 - api_server - INFO - 執行 Gemini 分析，任務: 'summary,transcript', 格式: 'html'
2025-08-12 07:59:40,943 - api_server - ERROR - ❌ [執行緒] YouTube 處理鏈中發生錯誤: Gemini processor failed with exit code 1. Stderr: {"type": "result", "status": "failed", "error": "GOOGLE_API_KEY environment variable not set."}
Traceback (most recent call last):
  File "/app/api_server.py", line 891, in _process_in_thread
    raise RuntimeError(f"Gemini processor failed with exit code {process_gemini.returncode}. Stderr: {stdout_output}")
RuntimeError: Gemini processor failed with exit code 1. Stderr: {"type": "result", "status": "failed", "error": "GOOGLE_API_KEY environment variable not set."}

2025-08-12 07:59:44,551 - api_server - INFO - ✅ 回傳任務 fe281860-43f1-4685-a5fc-7b2a8323b499 的狀態: failed
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [8778]
2025-08-12 08:00:13,759 - DBClient - INFO - 正在建立一個新的 DBClient 實例...
2025-08-12 08:00:13,759 - DBClient - INFO - 使用硬編碼的 DB Manager 埠號: 49999
2025-08-12 08:00:13,835 - api_server - INFO - 🚀 啟動 API 伺服器 (v3)...
2025-08-12 08:00:13,835 - api_server - INFO - 請在瀏覽器中開啟 http://127.0.0.1:42649
INFO:     Started server process [9167]
INFO:     Waiting for application startup.
2025-08-12 08:00:13,876 - api_server - INFO - 資料庫日誌處理器設定完成 (source: api_server)。
2025-08-12 08:00:13,881 - api_server - INFO - 資料庫日誌處理器已透過 lifespan 事件設定。
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:42649 (Press CTRL+C to quit)
INFO:     127.0.0.1:39896 - "WebSocket /api/ws" [accepted]
2025-08-12 08:00:14,884 - api_server - INFO - 新用戶端連線。目前共 1 個連線。
INFO:     connection open
2025-08-12 08:00:14,890 - api_server - INFO - 從 WebSocket 收到訊息: {"type": "START_YOUTUBE_PROCESSING", "payload": {"task_id": "6509f377-dfda-4a1a-9997-97645a383531"}}
2025-08-12 08:00:14,893 - api_server - INFO - 收到開始處理 YouTube 任務鏈的請求 (起始任務 ID: 6509f377-dfda-4a1a-9997-97645a383531)。
2025-08-12 08:00:14,896 - api_server - INFO - 🧵 [執行緒] 開始處理 YouTube 任務鏈，起始 ID: 6509f377-dfda-4a1a-9997-97645a383531
2025-08-12 08:00:14,897 - api_server - INFO - 一個用戶端離線。目前共 0 個連線。
2025-08-12 08:00:14,901 - api_server - INFO - WebSocket 用戶端已離線。
2025-08-12 08:00:14,906 - api_server - INFO - ✅ 回傳任務 468af73e-8c5b-466a-8163-d83e2f7e7f39 的狀態: pending
INFO:     connection closed
2025-08-12 08:00:15,106 - api_server - INFO - ✅ [執行緒] YouTube 音訊下載完成: /app/uploads/dummy_audio.wav
2025-08-12 08:00:15,115 - api_server - INFO - 執行 Gemini 分析，任務: 'summary,transcript', 格式: 'html'
2025-08-12 08:00:16,398 - api_server - ERROR - ❌ [執行緒] YouTube 處理鏈中發生錯誤: Gemini processor failed with exit code 1. Stderr: {"type": "result", "status": "failed", "error": "GOOGLE_API_KEY environment variable not set."}
Traceback (most recent call last):
  File "/app/api_server.py", line 891, in _process_in_thread
    raise RuntimeError(f"Gemini processor failed with exit code {process_gemini.returncode}. Stderr: {stdout_output}")
RuntimeError: Gemini processor failed with exit code 1. Stderr: {"type": "result", "status": "failed", "error": "GOOGLE_API_KEY environment variable not set."}

2025-08-12 08:00:19,916 - api_server - INFO - ✅ 回傳任務 468af73e-8c5b-466a-8163-d83e2f7e7f39 的狀態: failed
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [9167]
2025-08-12 08:01:01,933 - DBClient - INFO - 正在建立一個新的 DBClient 實例...
2025-08-12 08:01:01,933 - DBClient - INFO - 使用硬編碼的 DB Manager 埠號: 49999
2025-08-12 08:01:02,067 - api_server - INFO - 🚀 啟動 API 伺服器 (v3)...
2025-08-12 08:01:02,067 - api_server - INFO - 請在瀏覽器中開啟 http://127.0.0.1:42649
INFO:     Started server process [9585]
INFO:     Waiting for application startup.
2025-08-12 08:01:02,140 - api_server - INFO - 資料庫日誌處理器設定完成 (source: api_server)。
2025-08-12 08:01:02,148 - api_server - INFO - 資料庫日誌處理器已透過 lifespan 事件設定。
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:42649 (Press CTRL+C to quit)
INFO:     127.0.0.1:38168 - "WebSocket /api/ws" [accepted]
2025-08-12 08:01:02,495 - api_server - INFO - 新用戶端連線。目前共 1 個連線。
INFO:     connection open
2025-08-12 08:01:02,500 - api_server - INFO - 從 WebSocket 收到訊息: {"type": "START_YOUTUBE_PROCESSING", "payload": {"task_id": "23716551-9683-4f56-963c-8a177120080d"}}
2025-08-12 08:01:02,503 - api_server - INFO - 收到開始處理 YouTube 任務鏈的請求 (起始任務 ID: 23716551-9683-4f56-963c-8a177120080d)。
2025-08-12 08:01:02,506 - api_server - INFO - 🧵 [執行緒] 開始處理 YouTube 任務鏈，起始 ID: 23716551-9683-4f56-963c-8a177120080d
2025-08-12 08:01:02,507 - api_server - INFO - 一個用戶端離線。目前共 0 個連線。
2025-08-12 08:01:02,514 - api_server - INFO - WebSocket 用戶端已離線。
2025-08-12 08:01:02,520 - api_server - INFO - ✅ 回傳任務 24409176-460f-453c-8177-e3b7ac41ba26 的狀態: pending
INFO:     connection closed
2025-08-12 08:01:02,925 - api_server - INFO - ✅ [執行緒] YouTube 音訊下載完成: /app/uploads/dummy_audio.wav
2025-08-12 08:01:02,939 - api_server - INFO - 執行 Gemini 分析，任務: 'summary,transcript', 格式: 'html'
2025-08-12 08:01:04,831 - api_server - ERROR - ❌ [執行緒] YouTube 處理鏈中發生錯誤: Gemini processor failed with exit code 1. Stderr: {"type": "result", "status": "failed", "error": "GOOGLE_API_KEY environment variable not set."}
Traceback (most recent call last):
  File "/app/api_server.py", line 894, in _process_in_thread
    raise RuntimeError(f"Gemini processor failed with exit code {process_gemini.returncode}. Stderr: {stdout_output}")
RuntimeError: Gemini processor failed with exit code 1. Stderr: {"type": "result", "status": "failed", "error": "GOOGLE_API_KEY environment variable not set."}

2025-08-12 08:01:07,530 - api_server - INFO - ✅ 回傳任務 24409176-460f-453c-8177-e3b7ac41ba26 的狀態: failed
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [9585]

2025-08-13 01:25:03,249 - DBClient - INFO - 正在建立一個新的 DBClient 實例...
2025-08-13 01:25:03,249 - DBClient - INFO - 使用硬編碼的 DB Manager 埠號: 49999
2025-08-13 01:25:03,394 - api_server - INFO - 🚀 啟動 API 伺服器 (v3)...
2025-08-13 01:25:03,394 - api_server - INFO - 請在瀏覽器中開啟 http://127.0.0.1:42649
INFO:     Started server process [11722]
INFO:     Waiting for application startup.
2025-08-13 01:25:03,477 - api_server - INFO - 資料庫日誌處理器設定完成 (source: api_server)。
2025-08-13 01:25:03,484 - api_server - INFO - 資料庫日誌處理器已透過 lifespan 事件設定。
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:42649 (Press CTRL+C to quit)
2025-08-13 01:25:03,822 - api_server - WARNING - 偵測到舊版的 'urls' 負載格式，正在進行相容處理。
INFO:     127.0.0.1:47708 - "WebSocket /api/ws" [accepted]
2025-08-13 01:25:03,840 - api_server - INFO - 新用戶端連線。目前共 1 個連線。
INFO:     connection open
2025-08-13 01:25:03,844 - api_server - INFO - 從 WebSocket 收到訊息: {"type": "START_YOUTUBE_PROCESSING", "payload": {"task_id": "a7592501-4af7-40e8-a8d2-957c650d24f9"}}
2025-08-13 01:25:03,846 - api_server - INFO - 收到開始處理 YouTube 任務鏈的請求 (起始任務 ID: a7592501-4af7-40e8-a8d2-957c650d24f9)。
2025-08-13 01:25:03,849 - api_server - INFO - 🧵 [執行緒] 開始處理 YouTube 任務鏈，起始 ID: a7592501-4af7-40e8-a8d2-957c650d24f9
2025-08-13 01:25:03,850 - api_server - INFO - 一個用戶端離線。目前共 0 個連線。
2025-08-13 01:25:03,855 - api_server - INFO - WebSocket 用戶端已離線。
2025-08-13 01:25:03,861 - api_server - INFO - ✅ 回傳任務 a7592501-4af7-40e8-a8d2-957c650d24f9 的狀態: pending
INFO:     connection closed
2025-08-13 01:25:04,034 - api_server - ERROR - ❌ [執行緒] YouTube 處理鏈中發生錯誤: YouTube downloader failed: 2025-08-13 01:25:04,008 - youtube_downloader_tool - INFO - 開始下載音訊，URL: https://www.youtube.com/watch?v=jNQXAC9IVRw
2025-08-13 01:25:04,008 - youtube_downloader_tool - INFO - 執行 yt-dlp 指令: yt-dlp --print-json -f bestaudio -x --audio-format mp3 -o /app/uploads/%(title)s.%(ext)s https://www.youtube.com/watch?v=jNQXAC9IVRw
2025-08-13 01:25:04,009 - youtube_downloader_tool - ERROR - ❌ 下載過程中發生未預期的錯誤: [Errno 2] No such file or directory: 'yt-dlp'
Traceback (most recent call last):
  File "/app/tools/youtube_downloader.py", line 42, in download_audio
    result = subprocess.run(
             ^^^^^^^^^^^^^^^
  File "/home/jules/.pyenv/versions/3.12.11/lib/python3.12/subprocess.py", line 548, in run
    with Popen(*popenargs, **kwargs) as process:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jules/.pyenv/versions/3.12.11/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/home/jules/.pyenv/versions/3.12.11/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: 'yt-dlp'
Traceback (most recent call last):
  File "/app/api_server.py", line 871, in _process_in_thread
    raise RuntimeError(f"YouTube downloader failed: {stderr_output}")
RuntimeError: YouTube downloader failed: 2025-08-13 01:25:04,008 - youtube_downloader_tool - INFO - 開始下載音訊，URL: https://www.youtube.com/watch?v=jNQXAC9IVRw
2025-08-13 01:25:04,008 - youtube_downloader_tool - INFO - 執行 yt-dlp 指令: yt-dlp --print-json -f bestaudio -x --audio-format mp3 -o /app/uploads/%(title)s.%(ext)s https://www.youtube.com/watch?v=jNQXAC9IVRw
2025-08-13 01:25:04,009 - youtube_downloader_tool - ERROR - ❌ 下載過程中發生未預期的錯誤: [Errno 2] No such file or directory: 'yt-dlp'
Traceback (most recent call last):
  File "/app/tools/youtube_downloader.py", line 42, in download_audio
    result = subprocess.run(
             ^^^^^^^^^^^^^^^
  File "/home/jules/.pyenv/versions/3.12.11/lib/python3.12/subprocess.py", line 548, in run
    with Popen(*popenargs, **kwargs) as process:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jules/.pyenv/versions/3.12.11/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/home/jules/.pyenv/versions/3.12.11/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: 'yt-dlp'

2025-08-13 01:25:08,871 - api_server - INFO - ✅ 回傳任務 a7592501-4af7-40e8-a8d2-957c650d24f9 的狀態: failed
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [11722]
2025-08-13 04:07:12,323 - DBClient - INFO - 正在建立一個新的 DBClient 實例...
2025-08-13 04:07:12,323 - DBClient - INFO - 使用硬編碼的 DB Manager 埠號: 49999
2025-08-13 04:07:12,624 - api_server - INFO - 🚀 啟動 API 伺服器 (v3)...
2025-08-13 04:07:12,624 - api_server - INFO - 請在瀏覽器中開啟 http://127.0.0.1:42649
INFO:     Started server process [3222]
INFO:     Waiting for application startup.
2025-08-13 04:07:12,796 - api_server - INFO - 資料庫日誌處理器設定完成 (source: api_server)。
2025-08-13 04:07:12,803 - api_server - INFO - 資料庫日誌處理器已透過 lifespan 事件設定。
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:42649 (Press CTRL+C to quit)
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [3222]
2025-08-13 04:14:32,777 - DBClient - INFO - 正在建立一個新的 DBClient 實例...
2025-08-13 04:14:32,777 - DBClient - INFO - 使用硬編碼的 DB Manager 埠號: 49999
2025-08-13 04:14:33,183 - api_server - INFO - 🚀 啟動 API 伺服器 (v3)...
2025-08-13 04:14:33,183 - api_server - INFO - 請在瀏覽器中開啟 http://127.0.0.1:42649
INFO:     Started server process [2733]
INFO:     Waiting for application startup.
2025-08-13 04:14:33,412 - api_server - INFO - 資料庫日誌處理器設定完成 (source: api_server)。
2025-08-13 04:14:33,421 - api_server - INFO - 資料庫日誌處理器已透過 lifespan 事件設定。
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:42649 (Press CTRL+C to quit)
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [2733]
2025-08-13 04:15:06,876 - DBClient - INFO - 正在建立一個新的 DBClient 實例...
2025-08-13 04:15:06,876 - DBClient - INFO - 使用硬編碼的 DB Manager 埠號: 49999
2025-08-13 04:15:06,946 - api_server - INFO - 🚀 啟動 API 伺服器 (v3)...
2025-08-13 04:15:06,946 - api_server - INFO - 請在瀏覽器中開啟 http://127.0.0.1:42649
INFO:     Started server process [3107]
INFO:     Waiting for application startup.
2025-08-13 04:15:06,980 - api_server - INFO - 資料庫日誌處理器設定完成 (source: api_server)。
2025-08-13 04:15:06,985 - api_server - INFO - 資料庫日誌處理器已透過 lifespan 事件設定。
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:42649 (Press CTRL+C to quit)
2025-08-13 04:15:07,718 - frontend_action - INFO - fast_integration_test_action_98765
2025-08-13 04:15:07,720 - api_server - INFO - 📝 已將前端操作記錄到資料庫: fast_integration_test_action_98765
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [3107]
2025-08-13 04:15:28,896 - DBClient - INFO - 正在建立一個新的 DBClient 實例...
2025-08-13 04:15:28,896 - DBClient - INFO - 使用硬編碼的 DB Manager 埠號: 49999
2025-08-13 04:15:28,965 - api_server - INFO - 🚀 啟動 API 伺服器 (v3)...
2025-08-13 04:15:28,965 - api_server - INFO - 請在瀏覽器中開啟 http://127.0.0.1:42649
INFO:     Started server process [3433]
INFO:     Waiting for application startup.
2025-08-13 04:15:29,000 - api_server - INFO - 資料庫日誌處理器設定完成 (source: api_server)。
2025-08-13 04:15:29,003 - api_server - INFO - 資料庫日誌處理器已透過 lifespan 事件設定。
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:42649 (Press CTRL+C to quit)
2025-08-13 04:15:30,018 - frontend_action - INFO - fast_integration_test_action_98765
2025-08-13 04:15:30,020 - api_server - INFO - 📝 已將前端操作記錄到資料庫: fast_integration_test_action_98765
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [3433]
2025-08-13 04:16:29,887 - DBClient - INFO - 正在建立一個新的 DBClient 實例...
2025-08-13 04:16:29,888 - DBClient - INFO - 使用硬編碼的 DB Manager 埠號: 49999
2025-08-13 04:16:29,956 - api_server - INFO - 🚀 啟動 API 伺服器 (v3)...
2025-08-13 04:16:29,956 - api_server - INFO - 請在瀏覽器中開啟 http://127.0.0.1:42649
INFO:     Started server process [3984]
INFO:     Waiting for application startup.
2025-08-13 04:16:29,990 - api_server - INFO - 資料庫日誌處理器設定完成 (source: api_server)。
2025-08-13 04:16:29,994 - api_server - INFO - 資料庫日誌處理器已透過 lifespan 事件設定。
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:42649 (Press CTRL+C to quit)
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [3984]
2025-08-13 05:30:40,134 - DBClient - INFO - 正在建立一個新的 DBClient 實例...
2025-08-13 05:30:40,134 - DBClient - INFO - 使用硬編碼的 DB Manager 埠號: 49999
2025-08-13 05:30:40,258 - api_server - INFO - 🚀 啟動 API 伺服器 (v3)...
2025-08-13 05:30:40,258 - api_server - INFO - 請在瀏覽器中開啟 http://127.0.0.1:42649
INFO:     Started server process [7497]
INFO:     Waiting for application startup.
2025-08-13 05:30:40,354 - api_server - INFO - 資料庫日誌處理器設定完成 (source: api_server)。
2025-08-13 05:30:40,360 - api_server - INFO - 資料庫日誌處理器已透過 lifespan 事件設定。
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 42649): address already in use
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
2025-08-13 05:32:42,142 - DBClient - INFO - 正在建立一個新的 DBClient 實例...
2025-08-13 05:32:42,142 - DBClient - INFO - 使用硬編碼的 DB Manager 埠號: 49999
2025-08-13 05:32:42,265 - api_server - INFO - 🚀 啟動 API 伺服器 (v3)...
2025-08-13 05:32:42,265 - api_server - INFO - 請在瀏覽器中開啟 http://127.0.0.1:42649
INFO:     Started server process [8094]
INFO:     Waiting for application startup.
2025-08-13 05:32:42,353 - api_server - INFO - 資料庫日誌處理器設定完成 (source: api_server)。
2025-08-13 05:32:42,360 - api_server - INFO - 資料庫日誌處理器已透過 lifespan 事件設定。
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 42649): address already in use
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
2025-08-13 05:33:48,636 - DBClient - INFO - 正在建立一個新的 DBClient 實例...
2025-08-13 05:33:48,637 - DBClient - INFO - 使用硬編碼的 DB Manager 埠號: 49999
2025-08-13 05:33:48,749 - api_server - INFO - 🚀 啟動 API 伺服器 (v3)...
2025-08-13 05:33:48,749 - api_server - INFO - 請在瀏覽器中開啟 http://127.0.0.1:42649
INFO:     Started server process [8558]
INFO:     Waiting for application startup.
2025-08-13 05:33:48,815 - api_server - INFO - 資料庫日誌處理器設定完成 (source: api_server)。
2025-08-13 05:33:48,838 - api_server - INFO - 資料庫日誌處理器已透過 lifespan 事件設定。
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 42649): address already in use
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
